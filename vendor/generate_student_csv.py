# This file is a part of Projman, a group project orchestrator and management system,
# made by Team 5 for the COM3420 module [Software Hut] at the University of Sheffield.

# Originally genList.py - generates a class list csv, in the format given by the student
# records database, making up dummy students.

# Based on code generated by chatGPT, refined to match CEIS output. Prompt used:
#   I want to create some dummy data, a csv with the following column headers:
#
#   Surname, Forename, Middle Names, Title, Known As, Fee Status, Student Username,
#   Ucard No, Email, Reg. Status, Programme, Period, Module Code, 1st Grade, 2nd Grade,
#   3rd Grade, 4th Grade, NFC_Flag, HEFCE_Flag, Live Registration, Attending, Date of Birth,
#   Personal Tutor, Supervisors

import csv
import random
import faker    # if needed: pip install faker
import string
from faker import Faker
import datetime

fake = Faker('en_GB')

# Generate dummy data
data = []
for _ in range(234):  # Adjust the number as per your requirement
    surname = fake.last_name()
    forename = fake.first_name()
    middle_names = " ".join(fake.last_name() for _ in range(random.randint(0, 2)))
    title = random.choice(["Mr", "Ms", "Mrs", "Mx", "Miss"])
    known_as = fake.first_name()
    fee_status = random.choice(["Home", "Overseas"])
    student_username = f"{forename.lower()}.{surname.lower()}{random.randint(1, 999)}"
    student_username = f"AC{random.choice(string.ascii_uppercase)}{random.randint(19,22)}{forename[0]}{surname[0]}"
    ucard_no = fake.random_number(digits=9, fix_len=True)
    email = fake.email()
    reg_status = "Fully Registered"
    programme = random.choice(["COMU05","COMU117","COMU39","COMU101","COMU06","COMU43"])
    period = "B"
    module_code = "COM3420"
    grades = ["-","-","-","-"]
    nfc_flag = "-"
    hefce_flag = "Yes"
    live_registration = "Y"
    attending = "Y"
    dob = fake.date_of_birth(minimum_age=16, maximum_age=30)
    personal_tutor = fake.name()
    supervisors = ""

    data.append([
        surname, forename, middle_names, title, known_as, fee_status, student_username,
        ucard_no, email, reg_status, programme, period, module_code,
        *grades, nfc_flag, hefce_flag, live_registration, attending, dob,
        personal_tutor, supervisors
    ])

# Write data to CSV file
csv_file = "dummy_data.csv"
with open(csv_file, mode='w', newline='') as file:
    writer = csv.writer(file)
    # Write header
    writer.writerow([
        'Surname', 'Forename', 'Middle Names', 'Title', 'Known As', 'Fee Status',
        'Student Username', 'Ucard No', 'Email', 'Reg. Status', 'Programme',
        'Period', 'Module Code', '1st Grade', '2nd Grade', '3rd Grade', '4th Grade',
        'NFC_Flag', 'HEFCE_Flag', 'Live Registration', 'Attending', 'Date of Birth',
        'Personal Tutor', 'Supervisors'
    ])
    # Write data
    writer.writerows(data)

print(f"Dummy data has been generated and saved to {csv_file}")

