- unique_id = "teams_display_#{SecureRandom.hex(4)}"

// TODO: Dropdown for project selection and filters for team view
.card.mb-2.accordion-element
  %a.card-header.d-flex.justify-content-between.align-items-center{"data-bs-toggle" => "collapse",
   href: "##{unique_id}",
   role: "button",
   "data-accordion-toggle" => "",
   "aria-expanded" => "true",
   "aria-controls" => unique_id}

    %h2.fs-4= "Teams"
    %i.bi.bi-caret-right-fill

  .collapse.show{id: unique_id}
    .card-body
      %input.form-check-input{ type: "checkbox", id: "filter-checkbox", checked: true, onchange: "toggle_checkbox()" }
      %label.form-check-label{ for: "filter-checkbox" }= "Assigned only"

      %hr.divider

      %div#teams-display
        - @assigned_facilitators.each do |facilitator|
          - facilitator.groups.each do |group|
            .navigation-list-item
              = link_to facilitator_team_path(team_id: group.id) do
                %h6.p-1
                  = "#{group.assigned_facilitator.course_project.name} - #{group.name}"
  :javascript 
    function toggle_checkbox(element) {
      var checkbox = document.getElementById('filter-checkbox');

      fetch("facilitator/update_teams_list", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-CSRF-Token": document.querySelector("meta[name='csrf-token']").getAttribute("content")
        },
        body: JSON.stringify({ assigned_only: checkbox.checked })
      })
      .then(response => response.text())
      .then(data => {
        document.getElementById("teams-partial-container").innerHTML = data;
        document.getElementById("filter-checkbox").checked = checkbox.checked;
      })
      .catch(error => console.error('Error when updating teams partial:', error));
    }
    